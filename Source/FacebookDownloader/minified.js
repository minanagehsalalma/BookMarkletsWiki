javascript:void%20function(){javascript:(async()=%3E{const%20a=(a,b=document)=%3E[...b.querySelectorAll(a)],b=(a,b,c)=%3E{!a||a.startsWith(%22blob:%22)||c.has(a)||c.set(a,{u:a,...b})},c=a=%3EisFinite(a)%3Fnew%20Date(1e3*a).toISOString().substr(11,8):%22%20%3F%22,d=a=%3Ea%3F(a/1048576).toFixed(2)+%22%20MB%22:%22%20%3F%22;{const%20a=location.href.match(/[%3F%26]v=(\d{5,})/);a%26%26/facebook\.com\/watch/.test(location.href)%26%26history.replaceState(null,%22%22,`https://www.facebook.com/story.php%3Fstory_fbid=${a[1]}%26id=${a[1]}`)}const%20e=[...new%20Map([...(()=%3E{const%20c=new%20Map;return%20a(%22video%22).forEach(d=%3E{const%20e={w:d.videoWidth,h:d.videoHeight,d:d.duration};b(d.currentSrc||d.src,e,c),a(%22source%22,d).forEach(a=%3Eb(a.src,e,c))}),a(%22meta[property=\%22og:video\%22],%20meta[property=\%22og:video:secure_url\%22]%22).forEach(a=%3Eb(a.content,{},c)),a(%22[data-store]%22).forEach(a=%3E{let%20d=a.getAttribute(%22data-store%22);if(d)try{d=JSON.parse(d.replace(/%26quot;/g,%22\%22%22).replace(/%26amp;/g,%22%26%22)),[%22src%22,%22hd_src%22,%22sd_src%22].forEach(a=%3Eb(d[a],{},c))}catch{}}),[...c.values()]})(),...(()=%3E{const%20b=new%20Set,c=/%22(%3F:playable_url_quality_hd|playable_url|hd_src(%3F:_no_ratelimit)%3F|sd_src(%3F:_no_ratelimit)%3F)%22\s*:\s*%22([^%22]+%3F\.mp4[^%22]*%3F)%22/g;return%20a(%22script%22).forEach(a=%3E{for(let%20d;d=c.exec(a.textContent);)b.add(d[1].replace(/\\\//g,%22/%22).replace(/\\u0025/gi,%22%25%22).replace(/\\u0026/gi,%22%26%22))}),[...b].map(a=%3E({u:a}))})()].map(a=%3E[a.u,a])).values()];if(!e.length)return%20void%20alert(%22No%20video%20found.\n\u2022%20Click%20the%20play%20button%20once,%20then%20run%20the%20bookmarklet%20again.%22);await%20Promise.all(e.map(async%20a=%3E{try{a.sz=+(await%20fetch(a.u,{method:%22HEAD%22})).headers.get(%22content-length%22)||0}catch{a.sz=0}}));const%20f=document.createElement(%22div%22);f.id=%22fbDLgui%22,f.innerHTML=`
%20%20%3Cstyle%3E
%20%20%20%20%23fbDLgui{position:fixed;inset:0;z-index:2147483647;background:%230004;backdrop-filter:blur(2px);}
%20%20%20%20%23fbDLbox{position:absolute;top:8vh;left:50%25;transform:translateX(-50%25);
%20%20%20%20%20%20%20%20%20%20%20%20%20width:80%25;max-width:700px;height:80vh;background:%23fff;border-radius:10px;
%20%20%20%20%20%20%20%20%20%20%20%20%20box-shadow:0%206px%2024px%20%230003;display:flex;flex-direction:column;font:14px/1.4%20sans-serif;}
%20%20%20%20%23fbDLhdr{display:flex;align-items:center;justify-content:space-between;padding:10px%2016px;
%20%20%20%20%20%20%20%20%20%20%20%20%20background:%234267B2;color:%23fff;border-radius:10px%2010px%200%200;}
%20%20%20%20%23fbDLhdr%20h2{margin:0;font-size:15px;font-weight:600;}
%20%20%20%20%23fbDLclose{border:none;background:none;color:%23fff;font-size:22px;cursor:pointer;}
%20%20%20%20%23fbDLtbl{flex:1%201%20auto;margin:0%2016px%2016px;overflow:auto;border:1px%20solid%20%23ddd;}
%20%20%20%20%23fbDLtbl%20table{border-collapse:collapse;width:100%25;}
%20%20%20%20%23fbDLtbl%20th,%23fbDLtbl%20td{padding:6px%208px;text-align:left;border-bottom:1px%20solid%20%23eee;font-size:13px;}
%20%20%20%20%23fbDLtbl%20th{background:%23f5f6fa;position:sticky;top:0;}
%20%20%20%20%23fbDLtbl%20tr:hover{background:%23fafbff;}
%20%20%3C/style%3E
%20%20%3Cdiv%20id=%22fbDLbox%22%3E
%20%20%20%20%3Cdiv%20id=%22fbDLhdr%22%3E%3Ch2%3EFacebook%26nbsp;Video%26nbsp;Downloader%3C/h2%3E%3Cbutton%20id=%22fbDLclose%22%3E×%3C/button%3E%3C/div%3E
%20%20%20%20%3Cdiv%20id=%22fbDLtbl%22%3E%3Ctable%3E
%20%20%20%20%20%20%3Cthead%3E%3Ctr%3E%3Cth%3EFile%3C/th%3E%3Cth%3EResolution%3C/th%3E%3Cth%3EDuration%3C/th%3E%3Cth%3ESize%3C/th%3E%3C/tr%3E%3C/thead%3E
%20%20%20%20%20%20%3Ctbody%3E%3C/tbody%3E
%20%20%20%20%3C/table%3E%3C/div%3E
%20%20%3C/div%3E`,document.body.appendChild(f);const%20g=f.querySelector(%22tbody%22),h=a=%3E40%3Ca.length%3F`${a.slice(0,18)}…${a.slice(-18)}`:a;e.forEach(a=%3E{const%20b=h(decodeURIComponent(a.u.split(%22/%22).pop().split(%22%3F%22)[0])||%22(unnamed)%22),e=a.w%3F`${a.w}×${a.h}`:%22%20%3F%22,f=document.createElement(%22tr%22);f.innerHTML=`%3Ctd%3E%3Ca%20href=%22${a.u}%22%20target=%22_blank%22%20download%3E${b}%3C/a%3E%3C/td%3E
%20%20%20%20%20%20%20%3Ctd%3E${e}%3C/td%3E
%20%20%20%20%20%20%20%3Ctd%3E${c(a.d)}%3C/td%3E
%20%20%20%20%20%20%20%3Ctd%3E${d(a.sz)}%3C/td%3E`,g.appendChild(f)}),f.querySelector(%22%23fbDLclose%22).onclick=()=%3Ef.remove()})()}();
